<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Free Doc Audit Tool ‚Äî Docx.Doctor</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --navy: #0b1f4a; --navy2: #0d2560; --blue: #1a56db;
      --sky: #4a9eff; --mint: #3dd9ac; --white: #ffffff;
      --offwhite: #f0f5ff; --light: #e8f0fe; --gray: #64748b;
      --font-d: 'Playfair Display', Georgia, serif;
      --font-b: 'Outfit', sans-serif;
    }
    html { scroll-behavior: smooth; }
    body { font-family: var(--font-b); background: var(--white); color: var(--navy); overflow-x: hidden; }

    /* NAV ‚Äî exact copy from live site */
    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 200;
      display: flex; align-items: center; justify-content: space-between;
      padding: 1.1rem 5%;
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid rgba(26,86,219,0.1);
      transition: box-shadow 0.3s;
    }
    nav.scrolled { box-shadow: 0 4px 30px rgba(11,31,74,0.08); }
    .nav-logo { font-family: var(--font-d); font-size: 1.5rem; font-weight: 900; color: var(--navy); text-decoration: none; letter-spacing: -0.02em; }
    .nav-logo .dot { color: var(--blue); }
    .nav-logo .doc { color: var(--mint); }
    .nav-links { display: flex; gap: 2.5rem; list-style: none; align-items: center; }
    .nav-links a { font-size: 0.85rem; font-weight: 500; letter-spacing: 0.06em; text-transform: uppercase; color: var(--gray); text-decoration: none; transition: color 0.2s; }
    .nav-links a:hover { color: var(--blue); }
    .nav-cta { background: var(--blue) !important; color: var(--white) !important; padding: 0.55rem 1.5rem; border-radius: 50px; font-weight: 600 !important; transition: background 0.2s !important; }
    .nav-cta:hover { background: var(--navy) !important; }
    .nav-mobile-cta { display: none; background: var(--blue); color: var(--white); padding: 0.5rem 1.2rem; border-radius: 50px; font-size: 0.82rem; font-weight: 600; text-decoration: none; }
    @media (max-width: 720px) { .nav-links { display: none; } .nav-mobile-cta { display: inline-block; } }

    /* HERO ‚Äî dark navy, matches live site */
    .hero {
      background: var(--navy); padding: 9rem 5% 5rem;
      text-align: center; position: relative; overflow: hidden;
    }
    .hero::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse 60% 80% at 50% 110%, rgba(26,86,219,0.35) 0%, transparent 70%); }
    .hero-dots { position: absolute; inset: 0; pointer-events: none; background-image: radial-gradient(rgba(255,255,255,0.06) 1px, transparent 1px); background-size: 32px 32px; }
    .hero-inner { position: relative; z-index: 1; max-width: 680px; margin: 0 auto; }
    .hero-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(26,86,219,0.25); border: 1px solid rgba(74,158,255,0.3); color: var(--sky); padding: 0.4rem 1.1rem; border-radius: 50px; font-size: 0.72rem; font-weight: 600; letter-spacing: 0.1em; text-transform: uppercase; margin-bottom: 1.8rem; }
    .hero h1 { font-family: var(--font-d); font-size: clamp(2.8rem, 5vw, 4.5rem); font-weight: 900; color: var(--white); line-height: 1.05; letter-spacing: -0.02em; margin-bottom: 1rem; }
    .hero h1 em { font-style: italic; color: var(--sky); }
    .hero-sub { font-size: 1.05rem; font-weight: 300; color: rgba(255,255,255,0.6); line-height: 1.8; margin-bottom: 1.5rem; }
    .hero-privacy { font-size: 0.75rem; color: rgba(255,255,255,0.35); letter-spacing: 0.03em; }
    .hero-privacy strong { color: var(--mint); font-weight: 600; }

    /* MAIN */
    .main { max-width: 820px; margin: -3rem auto 5rem; padding: 0 5%; position: relative; z-index: 1; }

    /* CARDS ‚Äî white, matches live site service cards */
    .card { background: var(--white); border-radius: 16px; padding: 2.2rem 2rem; margin-bottom: 1.5rem; border: 1px solid rgba(26,86,219,0.08); box-shadow: 0 4px 24px rgba(11,31,74,0.07); }
    .section-label { font-size: 0.7rem; font-weight: 700; letter-spacing: 0.15em; text-transform: uppercase; color: var(--blue); margin-bottom: 1.5rem; }
    .section-label::before { content: '‚Äî '; }

    /* TABS */
    .tabs { display: flex; gap: 0.4rem; margin-bottom: 1.5rem; background: var(--offwhite); padding: 4px; border-radius: 10px; }
    .tab { flex: 1; padding: 0.65rem; border-radius: 8px; font-size: 0.83rem; font-weight: 500; border: none; cursor: pointer; transition: all 0.2s; background: transparent; color: var(--gray); font-family: var(--font-b); }
    .tab.active { background: var(--white); color: var(--navy); box-shadow: 0 2px 8px rgba(11,31,74,0.08); font-weight: 600; }

    /* TEXTAREA */
    textarea { width: 100%; min-height: 200px; border: 1.5px solid #e2e8f0; border-radius: 12px; padding: 1.2rem; font-family: var(--font-b); font-size: 0.92rem; color: var(--navy); resize: vertical; outline: none; line-height: 1.7; transition: border-color 0.2s, box-shadow 0.2s; background: var(--white); }
    textarea:focus { border-color: var(--blue); box-shadow: 0 0 0 3px rgba(26,86,219,0.08); }
    textarea::placeholder { color: #94a3b8; }

    /* FILE UPLOAD */
    #fileWrap { display: none; }
    .file-drop { border: 2px dashed #cbd5e1; border-radius: 12px; padding: 2.5rem 2rem; text-align: center; cursor: pointer; transition: all 0.2s; }
    .file-drop:hover { border-color: var(--blue); background: var(--light); }
    .file-drop-icon { font-size: 2rem; margin-bottom: 0.7rem; display: block; }
    .file-drop p { font-size: 0.9rem; color: var(--gray); }
    .file-drop strong { color: var(--navy); }
    .file-drop small { font-size: 0.75rem; color: #94a3b8; margin-top: 0.3rem; display: block; }
    #fileInput { display: none; }
    .file-selected { display: none; align-items: center; gap: 1rem; background: var(--light); border-radius: 10px; padding: 1rem 1.5rem; }
    .file-selected.show { display: flex; }
    .file-name { font-size: 0.88rem; font-weight: 600; color: var(--navy); }
    .file-size { font-size: 0.73rem; color: var(--gray); }
    .file-remove { margin-left: auto; background: none; border: none; color: var(--gray); cursor: pointer; font-size: 1rem; padding: 0.3rem 0.5rem; border-radius: 4px; transition: color 0.2s; }
    .file-remove:hover { color: #ef4444; }

    /* DOC TYPE ‚Äî matches .stag pill from live site */
    .type-label { font-size: 0.7rem; font-weight: 700; letter-spacing: 0.15em; text-transform: uppercase; color: var(--blue); margin: 1.4rem 0 0.7rem; }
    .type-label::before { content: '‚Äî '; }
    .doc-type-row { display: flex; gap: 0.5rem; flex-wrap: wrap; }
    .doc-type-btn { font-size: 0.65rem; font-weight: 600; letter-spacing: 0.08em; text-transform: uppercase; padding: 0.3rem 0.85rem; background: var(--light); color: var(--blue); border-radius: 50px; border: 1.5px solid transparent; cursor: pointer; transition: all 0.2s; font-family: var(--font-b); }
    .doc-type-btn:hover { border-color: var(--blue); }
    .doc-type-btn.selected { background: var(--blue); color: var(--white); }

    /* AUDIT BUTTON */
    .audit-btn { width: 100%; margin-top: 1.5rem; background: var(--blue); color: var(--white); border: none; border-radius: 50px; padding: 1rem 2rem; font-family: var(--font-b); font-size: 0.9rem; font-weight: 600; letter-spacing: 0.04em; cursor: pointer; transition: transform 0.15s, box-shadow 0.2s; display: flex; align-items: center; justify-content: center; gap: 0.5rem; box-shadow: 0 4px 20px rgba(26,86,219,0.35); }
    .audit-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 30px rgba(26,86,219,0.45); }

    /* LOADING */
    .loading { display: none; text-align: center; padding: 3rem 2rem; }
    .loading.show { display: block; }
    .spinner { width: 52px; height: 52px; border-radius: 50%; border: 4px solid var(--light); border-top-color: var(--blue); animation: spin 0.8s linear infinite; margin: 0 auto 1.2rem; }
    .loading-title { font-size: 1rem; font-weight: 600; color: var(--navy); margin-bottom: 0.4rem; }
    .loading-sub { font-size: 0.85rem; color: var(--gray); }
    .progress-bar-wrap { height: 5px; background: var(--light); border-radius: 3px; margin-top: 1.5rem; overflow: hidden; }
    .progress-bar { height: 100%; background: linear-gradient(90deg, var(--blue), var(--mint)); border-radius: 3px; width: 0; transition: width 0.4s ease; }

    /* RESULTS */
    .results { display: none; }
    .results.show { display: block; }

    /* SCORE CARD ‚Äî dark navy like process section on live site */
    .score-card { background: var(--navy); border-radius: 20px; padding: 2.5rem; margin-bottom: 1.5rem; text-align: center; position: relative; overflow: hidden; }
    .score-card::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 50% 120%, rgba(26,86,219,0.5) 0%, transparent 65%); }
    .score-label { font-size: 0.68rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--sky); font-weight: 700; margin-bottom: 0.8rem; position: relative; z-index: 1; }
    .score-num { font-family: var(--font-d); font-size: 6rem; font-weight: 900; line-height: 1; color: var(--white); position: relative; z-index: 1; }
    .score-denom { font-size: 2rem; color: rgba(255,255,255,0.25); }
    .score-grade { display: inline-block; margin-top: 0.8rem; padding: 0.4rem 1.2rem; border-radius: 50px; font-size: 0.85rem; font-weight: 700; position: relative; z-index: 1; }
    .score-summary { margin-top: 1rem; font-size: 0.92rem; font-weight: 300; color: rgba(255,255,255,0.55); line-height: 1.7; max-width: 500px; margin-left: auto; margin-right: auto; position: relative; z-index: 1; }

    /* CATEGORIES */
    .categories { display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.8rem; margin-bottom: 1.5rem; }
    .cat-card { background: var(--white); border-radius: 14px; padding: 1.1rem 0.6rem; text-align: center; border: 1px solid rgba(26,86,219,0.08); transition: transform 0.2s, box-shadow 0.2s; }
    .cat-card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(11,31,74,0.1); }
    .cat-icon { font-size: 1.3rem; margin-bottom: 0.4rem; display: block; }
    .cat-name { font-size: 0.6rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(--gray); margin-bottom: 0.4rem; }
    .cat-score { font-family: var(--font-d); font-size: 1.7rem; font-weight: 900; line-height: 1; color: var(--navy); }
    .cat-bar-wrap { height: 3px; background: var(--light); border-radius: 2px; margin-top: 0.6rem; overflow: hidden; }
    .cat-bar { height: 100%; border-radius: 2px; background: linear-gradient(90deg, var(--blue), var(--mint)); }

    /* WORD CHIPS */
    .chips-label { font-size: 0.7rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase; color: var(--gray); margin-bottom: 0.5rem; }
    .chips { display: flex; flex-wrap: wrap; gap: 0.4rem; margin-top: 0.5rem; }
    .chip { padding: 0.25rem 0.75rem; border-radius: 50px; font-size: 0.7rem; font-weight: 600; }
    .chip-red { background: #fef2f2; color: #ef4444; border: 1px solid #fca5a5; }
    .chip-yellow { background: #fffbeb; color: #d97706; border: 1px solid #fcd34d; }

    /* FINDINGS */
    .findings-label { font-size: 0.7rem; font-weight: 700; letter-spacing: 0.15em; text-transform: uppercase; color: var(--blue); margin-bottom: 1rem; }
    .findings-label::before { content: '‚Äî '; }
    .finding { display: flex; gap: 1rem; align-items: flex-start; padding: 0.9rem 0; border-bottom: 1px solid var(--offwhite); }
    .finding:last-child { border-bottom: none; padding-bottom: 0; }
    .fdot { width: 9px; height: 9px; border-radius: 50%; flex-shrink: 0; margin-top: 5px; }
    .d-red { background: #ef4444; } .d-yellow { background: #f59e0b; } .d-green { background: #10b981; } .d-blue { background: var(--blue); }
    .ftext { font-size: 0.87rem; color: var(--navy); line-height: 1.6; }
    .ftext strong { font-weight: 600; display: block; }
    .ftext span { color: var(--gray); font-weight: 300; font-size: 0.82rem; margin-top: 0.2rem; display: block; }

    /* RESULT CTA ‚Äî dark, matches contact section on live site */
    .result-cta { background: var(--navy); border-radius: 20px; padding: 2.5rem; text-align: center; position: relative; overflow: hidden; margin-bottom: 1.5rem; }
    .result-cta::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 50% 110%, rgba(26,86,219,0.4) 0%, transparent 65%); }
    .result-cta h3 { font-family: var(--font-d); font-size: 2rem; font-weight: 900; color: var(--white); margin-bottom: 0.8rem; position: relative; z-index: 1; letter-spacing: -0.01em; }
    .result-cta h3 em { font-style: italic; color: var(--sky); }
    .result-cta p { color: rgba(255,255,255,0.5); font-size: 0.92rem; margin-bottom: 1.8rem; line-height: 1.7; position: relative; z-index: 1; }
    .cta-row { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; position: relative; z-index: 1; }
    .cta-btn { padding: 0.95rem 2.2rem; border-radius: 50px; font-family: var(--font-b); font-size: 0.9rem; font-weight: 600; letter-spacing: 0.04em; text-decoration: none; transition: transform 0.15s, box-shadow 0.2s; display: inline-flex; align-items: center; gap: 0.5rem; }
    .cta-btn:hover { transform: translateY(-2px); }
    .cta-primary { background: var(--blue); color: var(--white); box-shadow: 0 4px 20px rgba(26,86,219,0.4); }
    .cta-primary:hover { box-shadow: 0 8px 30px rgba(26,86,219,0.5); }
    .cta-secondary { background: transparent; color: var(--white); border: 1px solid rgba(255,255,255,0.25); }
    .cta-secondary:hover { border-color: rgba(255,255,255,0.6); }

    /* RESET */
    .reset-btn { display: block; width: 100%; background: transparent; color: var(--gray); border: 1px solid #e2e8f0; border-radius: 50px; padding: 0.85rem; font-family: var(--font-b); font-size: 0.88rem; font-weight: 500; cursor: pointer; transition: all 0.2s; }
    .reset-btn:hover { border-color: var(--blue); color: var(--blue); }

    /* FOOTER ‚Äî exact copy from live site */
    footer { background: var(--navy); padding: 2rem 5%; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem; margin-top: 4rem; }
    .footer-logo { font-family: var(--font-d); font-size: 1.3rem; font-weight: 900; color: var(--white); text-decoration: none; }
    .footer-logo .dot { color: var(--blue); }
    .footer-logo .doc { color: var(--mint); }
    footer p { font-size: 0.75rem; color: rgba(255,255,255,0.35); }
    .footer-links { display: flex; gap: 2rem; list-style: none; }
    .footer-links a { font-size: 0.75rem; letter-spacing: 0.08em; text-transform: uppercase; color: rgba(255,255,255,0.4); text-decoration: none; transition: color 0.2s; }
    .footer-links a:hover { color: var(--white); }

    @keyframes spin { to { transform: rotate(360deg); } }
    @media (max-width: 650px) { .categories { grid-template-columns: repeat(3, 1fr); } .cta-row { flex-direction: column; align-items: center; } }
  </style>
</head>
<body>

<nav id="navbar">
  <a href="https://www.docxdoctor.com" class="nav-logo">Docx<span class="dot">.</span><span class="doc">Doctor</span></a>
  <ul class="nav-links">
    <li><a href="https://www.docxdoctor.com#services">Services</a></li>
    <li><a href="https://www.docxdoctor.com/templates.html">Free Templates</a></li>
    <li><a href="https://www.docxdoctor.com#why">Why Us</a></li>
    <li><a href="https://www.docxdoctor.com#contact" class="nav-cta">Get in Touch</a></li>
  </ul>
  <a href="https://www.docxdoctor.com#contact" class="nav-mobile-cta">Get in Touch</a>
</nav>

<div class="hero">
  <div class="hero-dots"></div>
  <div class="hero-inner">
    <div class="hero-badge">ü©∫ Free Doc Audit Tool</div>
    <h1>The Doc <em>Audit</em> Tool</h1>
    <p class="hero-sub">Paste your documentation and get an instant score across 5 dimensions ‚Äî clarity, structure, completeness, tone, and grammar. Free, runs entirely in your browser.</p>
    <p class="hero-privacy">100% Free &nbsp;¬∑&nbsp; No sign-up required &nbsp;¬∑&nbsp; <strong>Your documents are 100% private ‚Äî nothing is shared or stored</strong></p>
  </div>
</div>

<div class="main">

  <div class="card" id="inputCard">
    <div class="section-label">Your Documentation</div>
    <div class="tabs">
      <button class="tab active" id="tabText">‚úèÔ∏è Paste Text</button>
      <button class="tab" id="tabFile">üìé Upload File (PDF, Word, TXT)</button>
    </div>
    <div id="textWrap">
      <textarea id="docText" placeholder="Paste your API documentation, user guide, technical spec, or any documentation here...&#10;&#10;Tip: The more content you provide, the more detailed the analysis will be."></textarea>
    </div>
    <div id="fileWrap">
      <div class="file-drop" id="fileDrop">
        <span class="file-drop-icon">üìÇ</span>
        <p><strong>Click to upload</strong> or drag and drop</p>
        <small>Supports PDF, Word (.docx) and plain text (.txt)</small>
      </div>
      <input type="file" id="fileInput" accept=".txt,.pdf,.doc,.docx"/>
      <div class="file-selected" id="fileSelected">
        <span style="font-size:1.5rem">üìÑ</span>
        <div><div class="file-name" id="fileName"></div><div class="file-size" id="fileSize"></div></div>
        <button class="file-remove" id="fileRemoveBtn">‚úï</button>
      </div>
    </div>
    <div class="type-label">What type of document is this?</div>
    <div class="doc-type-row">
      <button class="doc-type-btn selected">API Documentation</button>
      <button class="doc-type-btn">User Guide</button>
      <button class="doc-type-btn">Technical Spec</button>
      <button class="doc-type-btn">Pitch Deck</button>
      <button class="doc-type-btn">Other</button>
    </div>
    <button class="audit-btn" id="auditBtn">ü©∫ Run Free Doc Audit</button>
  </div>

  <div class="card loading" id="loading">
    <div class="spinner"></div>
    <div class="loading-title" id="loadingMsg">Analysing your documentation...</div>
    <div class="loading-sub">Checking clarity, structure, completeness, tone &amp; grammar</div>
    <div class="progress-bar-wrap"><div class="progress-bar" id="progressBar"></div></div>
  </div>

  <div class="results" id="results">
    <div class="score-card">
      <div class="score-label">Overall Doc Health Score</div>
      <div class="score-num" id="overallScore">‚Äî<span class="score-denom">/100</span></div>
      <div class="score-grade" id="scoreGrade"></div>
      <div class="score-summary" id="scoreSummary"></div>
    </div>

    <div class="categories" id="categories"></div>

    <div class="card" id="wordSection" style="display:none">
      <div class="findings-label">Problematic Words Detected</div>
      <div id="weakWordsWrap"></div>
      <div id="jargonWrap"></div>
    </div>

    <div class="card">
      <div class="findings-label">Issues Found</div>
      <div id="issuesList"></div>
    </div>

    <div class="card">
      <div class="findings-label">Recommendations</div>
      <div id="recsList"></div>
    </div>

    <div class="card">
      <div class="findings-label">What's Working</div>
      <div id="strengthsList"></div>
    </div>

    <div class="result-cta">
      <h3>Ready to <em>Fix</em> Your Docs?</h3>
      <p>Let Docx.Doctor professionally rewrite and restructure your documentation ‚Äî so your users, developers, and investors actually understand your product.</p>
      <div class="cta-row">
        <a href="mailto:mandale.rutuja12@gmail.com?subject=Documentation Help" class="cta-btn cta-primary">üì© Get Professional Help</a>
        <a href="https://www.docxdoctor.com" class="cta-btn cta-secondary">Learn More ‚Üí</a>
      </div>
    </div>

    <button class="reset-btn" id="resetBtn">‚Ü© Run Another Audit</button>
  </div>

</div>

<footer>
  <a href="https://www.docxdoctor.com" class="footer-logo">Docx<span class="dot">.</span><span class="doc">Doctor</span></a>
  <p>¬© 2025 Docx.Doctor. All rights reserved.</p>
  <ul class="footer-links">
    <li><a href="https://www.docxdoctor.com#services">Services</a></li>
    <li><a href="https://www.docxdoctor.com/templates.html">Templates</a></li>
    <li><a href="https://www.docxdoctor.com#contact">Contact</a></li>
  </ul>
</footer>

<script>
  const WEAK = ['simply','basically','just','easily','obviously','clearly','very','really','quite','actually','literally','seamlessly','robust','leverage','utilize','synergy','innovative','cutting-edge','revolutionary','game-changing','groundbreaking','best-in-class','world-class'];
  const JARGON = ['paradigm','bandwidth','circle back','deep dive','boil the ocean','move the needle','low-hanging fruit','touch base','take offline','going forward','value-add','at the end of the day','in terms of'];
  const PASSIVE = /\b(is|are|was|were|be|been|being)\s+\w+ed\b/gi;

  const splitSentences = t => t.split(/[.!?]["']?\s+/).filter(s => s.trim().length > 8);
  const splitWords = t => t.trim().split(/\s+/).filter(Boolean);
  const countSyllables = w => { const m = w.toLowerCase().match(/[aeiouy]+/g); return m ? m.length : 1; };
  function fleschScore(text) {
    const w = splitWords(text).length, s = splitSentences(text).length;
    if (!w || !s) return 50;
    const syl = splitWords(text).reduce((a,w) => a + countSyllables(w), 0);
    return Math.max(0, Math.min(100, Math.round(206.835 - 1.015*(w/s) - 84.6*(syl/w))));
  }
  const avgSentLen = t => { const s = splitSentences(t); return s.length ? splitWords(t).length/s.length : 0; };
  const passiveRatio = t => { const s = splitSentences(t); if (!s.length) return 0; const m = t.match(PASSIVE); return (m?m.length:0)/s.length; };
  const clamp = v => Math.max(0, Math.min(100, Math.round(v)));

  function scoreClarity(text) {
    let s = 100;
    const avg = avgSentLen(text);
    if (avg > 30) s -= 30; else if (avg > 22) s -= 18; else if (avg > 16) s -= 8;
    const pr = passiveRatio(text);
    if (pr > 0.4) s -= 20; else if (pr > 0.2) s -= 10;
    const fk = fleschScore(text);
    if (fk < 30) s -= 25; else if (fk < 50) s -= 12;
    s -= Math.min(20, WEAK.filter(w => new RegExp("\\b"+w+"\\b","i").test(text)).length * 3);
    return clamp(s);
  }
  function scoreStructure(text) {
    let s = 35;
    if (/^#{1,3}\s.+/m.test(text) || /^.+\n[=\-]{3,}/m.test(text)) s += 20;
    if (/^[\*\-\+]\s.+|^\d+\.\s.+/m.test(text)) s += 15;
    if (/```[\s\S]*?```|`[^`]+`/.test(text)) s += 15;
    if (/introduction|overview|about|what is|getting started/i.test(text)) s += 5;
    if (/conclusion|summary|next steps/i.test(text)) s += 5;
    const wc = splitWords(text).length;
    if (wc < 100) s -= 20; else if (wc < 200) s -= 10;
    if (text.split(/\n\n+/).filter(p => p.trim().length > 30).length < 2) s -= 10;
    return clamp(s);
  }
  function scoreCompleteness(text, docType) {
    let s = 45;
    if (/introduction|overview|what is|getting started/i.test(text)) s += 12;
    if (/example|e\.g\.|for instance|such as|sample/i.test(text)) s += 12;
    if (/step|how to|click|navigate|first.*then/i.test(text)) s += 8;
    if (/conclusion|next steps|summary/i.test(text)) s += 8;
    if (docType === 'API Documentation') {
      if (/endpoint|request|response|parameter|auth/i.test(text)) s += 8;
      if (/error|status code|\b[45]\d\d\b/.test(text)) s += 7;
      if (!/```[\s\S]*?```|`[^`]+`/.test(text)) s -= 15;
    }
    if (docType === 'User Guide' && /step|click|select|navigate/i.test(text)) s += 8;
    if (docType === 'Pitch Deck') s += Math.min(15, ['problem','solution','market','revenue','team','traction','growth'].filter(k => new RegExp(k,'i').test(text)).length * 3);
    if (splitWords(text).length < 150) s -= 20;
    return clamp(s);
  }
  function scoreTone(text, docType) {
    let s = 68;
    s -= Math.min(25, JARGON.filter(j => new RegExp("\\b"+j+"\\b","i").test(text)).length * 5);
    if (/\byou\b|\byour\b/i.test(text)) s += 10;
    if (/\bwe\b|\bour\b/i.test(text)) s += 5;
    if ((docType==='API Documentation'||docType==='Technical Spec') && /must|shall|should|may\b|note:|warning:/i.test(text)) s += 10;
    if (docType==='Pitch Deck' && /we believe|our mission|transforming/i.test(text)) s += 8;
    if ((text.match(/!/g)||[]).length > 6) s -= 10;
    return clamp(s);
  }
  function scoreGrammar(text) {
    let s = 88;
    if (/  +/.test(text)) s -= 5;
    if (/\b(\w+)\s+\1\b/i.test(text)) s -= 12;
    if (/[,\.][A-Z]/.test(text)) s -= 8;
    if ((text.match(/\b(api|url|http|json|xml|sdk)\b/g)||[]).length > 2) s -= 8;
    s -= text.split(/\n\n+/).filter(p => splitWords(p).length > 150).length * 5;
    return clamp(s);
  }

  function buildIssues(text, cats, docType) {
    const i = [];
    const avg = avgSentLen(text);
    if (avg > 22) i.push({sev:'high', title:'Sentences too long (avg '+Math.round(avg)+' words)', detail:'Aim for 15‚Äì18 words per sentence. Long sentences reduce comprehension.'});
    if (cats.structure < 65 && !/^#{1,3}\s.+/m.test(text)) i.push({sev:'high', title:'No headings detected', detail:'Headings let readers scan and navigate. Use ## Section Title style headers throughout.'});
    if ((docType==='API Documentation'||docType==='Technical Spec') && !/```[\s\S]*?```|`[^`]+`/.test(text)) i.push({sev:'high', title:'No code examples found', detail:'Developers need working code to integrate quickly. Add at least one example per endpoint.'});
    if (passiveRatio(text) > 0.25) i.push({sev:'medium', title:'Heavy passive voice', detail:'"The user clicks the button" beats "The button is clicked by the user."'});
    if (!/example|e\.g\.|for instance|such as/i.test(text)) i.push({sev:'medium', title:'No examples found', detail:'Concrete examples dramatically improve comprehension.'});
    if (!/introduction|overview|what is|getting started/i.test(text)) i.push({sev:'medium', title:'Missing introduction', detail:'Tell readers what this doc is, who it\'s for, and what they\'ll be able to do.'});
    if (splitWords(text).length < 200) i.push({sev:'medium', title:'Document appears incomplete', detail:'Good technical docs are at least 300‚Äì500 words per major section.'});
    if (fleschScore(text) < 40) i.push({sev:'medium', title:'Low readability score', detail:'Use shorter words, shorter sentences, and simpler phrasing.'});
    const wf = WEAK.filter(w => new RegExp("\\b"+w+"\\b","i").test(text));
    if (wf.length > 3) i.push({sev:'low', title:wf.length+' filler words detected', detail:'Words like "'+wf.slice(0,3).join('", "')+'" weaken your writing.'});
    if (!/conclusion|next steps|summary/i.test(text)) i.push({sev:'low', title:'No conclusion or next steps', detail:'Always tell readers what to do next.'});
    return i.slice(0, 6);
  }
  function buildRecs(text, cats, docType) {
    const r = [];
    if (cats.structure < 70) r.push({title:'Add clear headings', detail:'Break your doc into logical sections. This is the fastest way to improve scannability.'});
    if (!/```[\s\S]*?```|`[^`]+`/.test(text)) r.push({title:'Add working code examples', detail:'For every concept, show working code. Code examples reduce support tickets dramatically.'});
    if (!/example|e\.g\.|for instance/i.test(text)) r.push({title:'Add real-world examples', detail:'After every concept, add a concrete example. This is the #1 driver of comprehension.'});
    if (cats.clarity < 70) r.push({title:'Shorten your sentences', detail:'Break any sentence over 20 words into two. Read it aloud ‚Äî if you run out of breath, split it.'});
    if (!/introduction|overview/i.test(text)) r.push({title:'Write a 2-sentence introduction', detail:'Answer: what is this, who is it for, what can the reader do after reading it.'});
    if (cats.completeness < 70) r.push({title:'Add a Quick Start section', detail:'Give readers the fastest path to success ‚Äî 5 steps, 5 minutes.'});
    r.push({title:'Get an outsider to read it', detail:'If someone unfamiliar with your product can follow your docs without questions, they\'re good.'});
    return r.slice(0, 5);
  }
  function buildStrengths(text, cats) {
    const s = [];
    if (/```[\s\S]*?```|`[^`]+`/.test(text)) s.push({title:'Includes code examples', detail:'Code samples are one of the most valuable elements in technical documentation.'});
    if (/^#{1,3}\s.+/m.test(text)) s.push({title:'Well-structured with headings', detail:'Headings make your document easy to scan and navigate.'});
    if (/^[\*\-\+]\s.+|^\d+\.\s.+/m.test(text)) s.push({title:'Uses lists effectively', detail:'Lists break up dense information and make content easier to absorb.'});
    if (cats.grammar >= 78) s.push({title:'Clean writing', detail:'Grammatically sound writing builds credibility with readers.'});
    if (/example|e\.g\.|for instance/i.test(text)) s.push({title:'Uses examples', detail:'Illustrating concepts with examples significantly improves comprehension.'});
    if (avgSentLen(text) <= 16 && avgSentLen(text) > 0) s.push({title:'Concise sentences', detail:'Your sentence length is in the ideal range ‚Äî easy to read and understand.'});
    if (s.length === 0) s.push({title:'You\'re taking docs seriously', detail:'Running an audit means you care about quality. That puts you ahead of most teams.'});
    return s.slice(0, 3);
  }
  function getGrade(score) {
    if (score >= 85) return {label:'Excellent', color:'#10b981'};
    if (score >= 70) return {label:'Good', color:'#3dd9ac'};
    if (score >= 55) return {label:'Fair', color:'#f59e0b'};
    if (score >= 40) return {label:'Poor', color:'#ef4444'};
    return {label:'Critical', color:'#dc2626'};
  }
  function getSummary(score, docType) {
    if (score >= 85) return 'Your '+docType+' is in great shape ‚Äî clear, structured, and complete.';
    if (score >= 70) return 'Your '+docType+' is solid but has room to grow. The issues below will help you push it further.';
    if (score >= 55) return 'Your '+docType+' needs work in several areas. Addressing the issues below will significantly improve it.';
    if (score >= 40) return 'Your '+docType+' has significant problems likely causing confusion. A thorough review is recommended.';
    return 'Your '+docType+' needs a major overhaul. Consider reaching out to Docx.Doctor for professional help.';
  }

  function runAudit() {
    const isText = document.getElementById('tabText').classList.contains('active');
    const docType = document.querySelector('.doc-type-btn.selected')?.textContent || 'documentation';
    const content = isText ? document.getElementById('docText').value.trim() : (window._fileText || '');
    if (!content || content.length < 60) { alert('Please provide more content ‚Äî at least a short paragraph for a meaningful audit.'); return; }

    document.getElementById('inputCard').style.display = 'none';
    document.getElementById('loading').classList.add('show');
    document.getElementById('results').classList.remove('show');

    const msgs = ['Reading your document...','Checking clarity & readability...','Evaluating sentence length...','Scanning for structure...','Checking completeness...','Analysing tone & vocabulary...','Reviewing grammar...','Building your report...'];
    let mi = 0;
    const msgIv = setInterval(() => { document.getElementById('loadingMsg').textContent = msgs[mi++ % msgs.length]; }, 400);
    let prog = 0;
    const progIv = setInterval(() => { prog = Math.min(prog+3, 90); document.getElementById('progressBar').style.width = prog+'%'; }, 80);

    setTimeout(() => {
      clearInterval(msgIv); clearInterval(progIv);
      document.getElementById('progressBar').style.width = '100%';
      setTimeout(() => {
        document.getElementById('loading').classList.remove('show');
        const cats = {
          clarity: scoreClarity(content), structure: scoreStructure(content),
          completeness: scoreCompleteness(content, docType), tone: scoreTone(content, docType),
          grammar: scoreGrammar(content)
        };
        const overall = Math.round(Object.values(cats).reduce((a,b)=>a+b,0)/5);
        const grade = getGrade(overall);

        document.getElementById('overallScore').innerHTML = overall+'<span class="score-denom">/100</span>';
        const gradeEl = document.getElementById('scoreGrade');
        gradeEl.textContent = grade.label; gradeEl.style.background = grade.color; gradeEl.style.color = 'white';
        document.getElementById('scoreSummary').textContent = getSummary(overall, docType);

        document.getElementById('categories').innerHTML = [
          {key:'clarity',icon:'üí¨',name:'Clarity'},{key:'structure',icon:'üèó',name:'Structure'},
          {key:'completeness',icon:'‚úÖ',name:'Complete'},{key:'tone',icon:'üéØ',name:'Tone'},{key:'grammar',icon:'‚úç',name:'Grammar'}
        ].map(c => '<div class="cat-card"><span class="cat-icon">'+c.icon+'</span><div class="cat-name">'+c.name+'</div><div class="cat-score">'+cats[c.key]+'</div><div class="cat-bar-wrap"><div class="cat-bar" style="width:'+cats[c.key]+'%"></div></div></div>').join('');

        const weakFound = WEAK.filter(w => new RegExp("\\b"+w+"\\b","i").test(content));
        const jFound = JARGON.filter(j => new RegExp("\\b"+j+"\\b","i").test(content));
        if (weakFound.length || jFound.length) {
          document.getElementById('wordSection').style.display = 'block';
          if (weakFound.length) document.getElementById('weakWordsWrap').innerHTML = '<div class="chips-label">Filler / Weak Words ('+weakFound.length+' found)</div><div class="chips">'+weakFound.map(w=>'<span class="chip chip-red">'+w+'</span>').join('')+'</div>';
          if (jFound.length) document.getElementById('jargonWrap').innerHTML = '<div class="chips-label" style="margin-top:1rem">Jargon / Buzzwords ('+jFound.length+' found)</div><div class="chips">'+jFound.map(w=>'<span class="chip chip-yellow">'+w+'</span>').join('')+'</div>';
        }

        const sevDot = {high:'d-red', medium:'d-yellow', low:'d-green'};
        const issues = buildIssues(content, cats, docType);
        document.getElementById('issuesList').innerHTML = issues.length
          ? issues.map(i=>'<div class="finding"><div class="fdot '+sevDot[i.sev]+'"></div><div class="ftext"><strong>'+i.title+'</strong><span>'+i.detail+'</span></div></div>').join('')
          : '<div class="finding"><div class="fdot d-green"></div><div class="ftext"><strong>No major issues found!</strong><span>Your documentation is in great shape.</span></div></div>';

        const recs = buildRecs(content, cats, docType);
        document.getElementById('recsList').innerHTML = recs.map(r=>'<div class="finding"><div class="fdot d-blue"></div><div class="ftext"><strong>'+r.title+'</strong><span>'+r.detail+'</span></div></div>').join('');

        const strengths = buildStrengths(content, cats);
        document.getElementById('strengthsList').innerHTML = strengths.map(s=>'<div class="finding"><div class="fdot d-green"></div><div class="ftext"><strong>'+s.title+'</strong><span>'+s.detail+'</span></div></div>').join('');

        document.getElementById('results').classList.add('show');
        window.scrollTo({top:0, behavior:'smooth'});
      }, 300);
    }, 2200);
  }

  function resetAudit() {
    document.getElementById('inputCard').style.display = 'block';
    document.getElementById('results').classList.remove('show');
    document.getElementById('wordSection').style.display = 'none';
    document.getElementById('weakWordsWrap').innerHTML = '';
    document.getElementById('jargonWrap').innerHTML = '';
    document.getElementById('progressBar').style.width = '0';
    document.getElementById('docText').value = '';
    removeFile();
    window.scrollTo({top:0, behavior:'smooth'});
  }

  function handleFile(e) {
    const file = e.target.files[0]; if (!file) return;
    document.getElementById('fileDrop').style.display = 'none';
    document.getElementById('fileSelected').classList.add('show');
    document.getElementById('fileName').textContent = file.name;
    document.getElementById('fileSize').textContent = (file.size/1024).toFixed(1)+' KB';
    window._fileText = null;
    const ext = file.name.split('.').pop().toLowerCase();
    if (ext === 'txt') {
      const fr = new FileReader(); fr.onload = ev => { window._fileText = ev.target.result; }; fr.readAsText(file);
    } else if (ext === 'pdf') {
      const fr = new FileReader();
      fr.onload = async ev => {
        try {
          pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
          const pdf = await pdfjsLib.getDocument({data: new Uint8Array(ev.target.result)}).promise;
          let text = '';
          for (let i = 1; i <= pdf.numPages; i++) { const page = await pdf.getPage(i); const c = await page.getTextContent(); text += c.items.map(it=>it.str).join(' ')+'\n\n'; }
          window._fileText = text.trim();
        } catch(err) { alert('Could not read PDF. Make sure it contains selectable text.'); removeFile(); }
      }; fr.readAsArrayBuffer(file);
    } else if (ext === 'docx' || ext === 'doc') {
      const fr = new FileReader();
      fr.onload = async ev => {
        try { const result = await mammoth.extractRawText({arrayBuffer: ev.target.result}); window._fileText = result.value.trim(); }
        catch(err) { alert('Could not read Word document. Try saving as .docx and uploading again.'); removeFile(); }
      }; fr.readAsArrayBuffer(file);
    } else { alert('Unsupported file type. Please upload PDF, Word (.docx), or plain text (.txt).'); removeFile(); }
  }

  function removeFile() {
    document.getElementById('fileInput').value = '';
    document.getElementById('fileDrop').style.display = 'block';
    document.getElementById('fileSelected').classList.remove('show');
    window._fileText = null;
  }

  // All event listeners ‚Äî no inline onclick handlers (Cloudflare-safe)
  document.getElementById('auditBtn').addEventListener('click', runAudit);
  document.getElementById('resetBtn').addEventListener('click', resetAudit);
  document.getElementById('fileRemoveBtn').addEventListener('click', removeFile);
  document.getElementById('fileInput').addEventListener('change', handleFile);
  document.getElementById('fileDrop').addEventListener('click', () => document.getElementById('fileInput').click());

  document.getElementById('tabText').addEventListener('click', function() {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    this.classList.add('active');
    document.getElementById('textWrap').style.display = 'block';
    document.getElementById('fileWrap').style.display = 'none';
  });
  document.getElementById('tabFile').addEventListener('click', function() {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    this.classList.add('active');
    document.getElementById('textWrap').style.display = 'none';
    document.getElementById('fileWrap').style.display = 'block';
  });
  document.querySelectorAll('.doc-type-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      document.querySelectorAll('.doc-type-btn').forEach(b => b.classList.remove('selected'));
      this.classList.add('selected');
    });
  });

  const fd = document.getElementById('fileDrop');
  fd.addEventListener('dragover', e => { e.preventDefault(); fd.style.borderColor='var(--blue)'; fd.style.background='var(--light)'; });
  fd.addEventListener('dragleave', () => { fd.style.borderColor=''; fd.style.background=''; });
  fd.addEventListener('drop', e => { e.preventDefault(); fd.style.borderColor=''; fd.style.background=''; if (e.dataTransfer.files[0]) handleFile({target:{files:e.dataTransfer.files}}); });

  window.addEventListener('scroll', () => {
    document.getElementById('navbar').classList.toggle('scrolled', window.scrollY > 20);
  });
</script>
</body>
</html>
